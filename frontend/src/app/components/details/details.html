<div class="details-container">
  <div class="details-header">
    <h2>{{ task.title }}</h2>
    <p class="date">ğŸ“… {{ task.samplingDateTime | date:'fullDate' }} - {{ task.samplingDateTime | date:'shortTime' }}</p>
  </div>

  <div class="export-buttons">
    <button class="btn-export pdf" (click)="exportPDF()">ğŸ“„ Exportar PDF</button>
    <button class="btn-export csv" (click)="exportCSV()">ğŸ“Š Exportar CSV</button>
  </div>

  <div class="details-map-container">
    <h3>ğŸ“ UbicaciÃ³n del Muestreo</h3>
    <div id="details-map" class="details-map"></div>
    <p class="coords">Lat: {{ task.location.latitude }} | Lng: {{ task.location.longitude }}</p>
  </div>

  <div class="details-section">
    <h3>ğŸŒ¡ï¸ Condiciones ClimÃ¡ticas</h3>
    <p>{{ task.weatherConditions }}</p>
  </div>

  <div class="details-section">
    <h3>ğŸï¸ DescripciÃ³n del HÃ¡bitat</h3>
    <p>{{ task.habitatDescription }}</p>
  </div>

  @if (task.samplingPhotos && task.samplingPhotos.length > 0) {
    <div class="details-section">
      <h3>ğŸ“¸ Fotos del Muestreo</h3>
      <div class="photo-grid">
        @for (photo of task.samplingPhotos; track photo) {
          <img [src]="photo" alt="Foto de muestreo" class="detail-photo" />
        }
      </div>
    </div>
  }

  @if (task.speciesDetails && task.speciesDetails.length > 0) {
    <div class="details-section">
      <h3>ğŸŒ¿ Especies Registradas</h3>
      @for (species of task.speciesDetails; track species.scientificName; let i = $index) {
        <div class="species-detail-card">
          <div class="species-info-grid">
            <div><strong>Nombre CientÃ­fico:</strong> <em>{{ species.scientificName }}</em></div>
            <div><strong>Nombre ComÃºn:</strong> {{ species.commonName }}</div>
            <div><strong>Familia:</strong> {{ species.family }}</div>
            <div><strong>Cantidad:</strong> {{ species.sampleQuantity }}</div>
            <div><strong>Estado:</strong> {{ species.plantState }}</div>
          </div>
          @if (species.speciesPhotos && species.speciesPhotos.length > 0) {
            <div class="photo-grid">
              @for (photo of species.speciesPhotos; track photo) {
                <img [src]="photo" [alt]="species.scientificName" class="detail-photo" />
              }
            </div>
          }
        </div>
      }
    </div>
  }

  @if (task.additionalObservations) {
    <div class="details-section">
      <h3>ğŸ“ Observaciones Adicionales</h3>
      <p>{{ task.additionalObservations }}</p>
    </div>
  }
</div>
